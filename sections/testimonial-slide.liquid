{% liquid
  assign id = section.id
%}

<style>
  #shopify-section-{{ id }} {
    box-sizing: border-box;
    margin-top: {{ section.settings.margin_top | append: 'px' }};
    margin-bottom: {{ section.settings.margin_bottom | append: 'px' }};
    padding-top: {{ section.settings.padding_top | append: 'px' }};
    padding-bottom: {{ section.settings.padding_bottom | append: 'px' }};
    background: #FEF9F2;
    .--section-title {
      margin: 0 0 20px;
    }
  }

  @media (max-width: 768px) {
    #shopify-section-{{ id }} {
      margin-top: {{ section.settings.margin_top_m | append: 'px' }};
      margin-bottom: {{ section.settings.margin_bottom_m | append: 'px' }};
      padding-top: {{ section.settings.padding_top_m | append: 'px' }};
      padding-bottom: {{ section.settings.padding_bottom_m | append: 'px' }};
    }
    .swiper-wrapper {
      align-items: flex-end;
    }    
  }

  .sec-{{ id }} .page-width {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 15px;
  }

  .container--{{ id }} {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
  }
  .--img {
      max-width: 100%;
      height: auto;
      width: 100%;
      object-fit: cover;
  }
  .wrapper-{{ id }},
  .image__wrapper-{{ id }} {
    flex: 1;
    min-width: 300px;
    position: relative;
  }

  .testimonial__card {
    background: var(--Color-Netural-White, #FFF);
    border-radius: 0;
    padding: 24px;
    text-align: left;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .testimonial__card h3 {
    color: var(--Color-Gray-950, #0C0A09);

    /* sm/Regular */
    font-family: "Noto Serif";
    font-size: 30px;
    font-style: normal;
    font-weight: 300;
    line-height: 120%; /* 36px */
    letter-spacing: -0.6px;
    margin: 24px 0 16px;
  }

  .testimonial__card .text {
    color: var(--Color-Gray-700, #44403C);

    /* Text md/Medium */
    font-family: Lato;
    font-size: 16px;
    font-style: normal;
    font-weight: 400;
    line-height: 150%; /* 24px */
    margin: 0 0 16px;
  }
    .rating {
      margin: 0;
    }

  .user__wrrap {
    display: flex;
    align-items: center;
    justify-content: start;
    flex-direction: row-reverse;
    gap: 10px;
  }

  .user_img {
    border-radius: 50%;
    width: 40px;
    height: 40px;
  }
  .--user {
    color: var(--Color-Gray-950, #0C0A09);

    /* Text lg/Medium */
    font-family: Lato;
    font-size: 18px;
    font-style: normal;
    font-weight: 400;
    line-height: 150%; /* 27px */    
    margin: 0;
  }
  .rating {
    width: 128px;
    height: 24px;
    margin: 0;
  }
    .sec-{{ id }} {
      .swiper {
          width: 100%;
          height: 600px;
      }
   }

   .swiper.testimonial--{{ id }} .swiper-slide {
        display: flex;
        justify-content: center;
        align-items: start;
    }
  .--img {
    max-width: 100%;
    height: 100%;
  }
  .containenr__image--{{ id }} {
    max-width: 100%;
    position: absolute;
    bottom: 0;
    left: 0;
    @media(max-width: 768px) {
      bottom: 0;
    }
  }
  .containenr__image--{{ id }} .swiper{
    height: max-content;
  }
  .swiper-button-next--{{ id }}, .swiper-button-prev--{{ id }} {
    position: relative;
    cursor: pointer;
  }
  .--single_testimonial__card {
    background: rgba(255, 255, 255, 0.9);
    padding: 15px;
    border-radius: 0;
    margin: 32px 24px;
  }
  .ts__nev {
    display: flex;
    align-items: center;
    gap: 24px;
  }
   .testimonial--{{ id }} .testimonial__card {
      border: 1px solid var(--Color-Gray-200, #E7E5E4);
      background: inherit;
      min-height: 250px;
      padding: 15px;
  }
</style>

<div class="sec-{{ id }}">
  <div class="{% unless section.settings.full_width %}page-width{% endunless %}">
    <div class="container--{{ id }}">
      <div class="wrapper-{{ id }}">
        <div>
          <h2 class="--section-title">{{ 'Testimonials' }}</h2>
          <div class="swiper testimonial--{{ id }}">
            <div class="swiper-wrapper">
              {% for block in section.blocks %}
                <div class="swiper-slide">
                  <div class="testimonial__card">
                    {% unless block.settings.rating == blank %}
                      {{ block.settings.rating | image_url: width: 128, height: 24 | image_tag: class: 'rating' }}
                    {% endunless %}
                    <h3>{{ block.settings.title }}</h3>
                    <p class="text">{{ block.settings.content }}</p>
                    <div class="user__wrrap">
                      <p class="--user">{{ block.settings.username }}</p>
                      {% unless block.settings.user == blank %}
                        {{ block.settings.user | image_url: width: 40, height: 40 | image_tag: class: 'user_img' }}
                      {% endunless %}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
        <div class="ts__nev">
          <div class="swiper-button-prev--{{ id }}">{% render 'all-icons', name: 'left' %}</div>
          <div class="swiper-button-next--{{ id }}">{% render 'all-icons', name: 'right' %}</div>
        </div>
      </div>
      <div class="image__wrapper-{{ id }}">
        {% unless section.settings.image == blank %}
          {{ section.settings.image | image_url: width: section.settings.image.width | image_tag: class: '--img' }}
        {% endunless %}
        <div class="containenr__image--{{ id }}">
          <div class="swiper image--{{ id }}">
            <div class="swiper-wrapper">
              {% for block in section.blocks %}
                <div class="swiper-slide">
                  <div class="--single_image">
                    <div class="testimonial__card --single_testimonial__card">
                      {% unless block.settings.rating == blank %}
                        {{ block.settings.rating | image_url: width: 128, height: 24 | image_tag: class: 'rating' }}
                      {% endunless %}
                      <h3>{{ block.settings.title }}</h3>
                      <p class="text">{{ block.settings.content }}</p>
                      <div class="user__wrrap">
                        <p class="--user">{{ block.settings.username }}</p>
                        {% unless block.settings.user == blank %}
                          {{ block.settings.user | image_url: width: 40, height: 40 | image_tag: class: 'user_img' }}
                        {% endunless %}
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    
    var swiper = new Swiper('.testimonial--{{ id }}', {
      direction: 'vertical',
      loop: false,
      autoplay: {
        delay: 5000,
        disableOnInteraction: true,
      },
      navigation: {
        nextEl: '.swiper-button-next--{{ id }}',
        prevEl: '.swiper-button-prev--{{ id }}',
      },
      slidesPerView: 2,
    });

    var swiper2 = new Swiper('.image--{{ id }}', {
      loop: false,
      autoplay: {
        delay: 5000,
        disableOnInteraction: true,
      },
      slidesPerView: 1,
      spaceBetween: 0,
    });
  });
</script>

{% schema %}
{
  "name": "Testimonial Slide",
  "settings": [
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background Image"
    },
    {
      "type": "header",
      "content": "Section Spacing Desktop"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 48
    },
    {
      "type": "header",
      "content": "Section Spacing Mobile"
    },
    {
      "type": "range",
      "id": "margin_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 32
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Testimonial Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "rating",
          "label": "Rating Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "textarea",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "text",
          "id": "username",
          "label": "Username"
        },
        {
          "type": "image_picker",
          "id": "user",
          "label": "User Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonial Slide"
    }
  ]
}
{% endschema %}
