{{ 'faq-list.css' | asset_url | stylesheet_tag }}
{% liquid
  assign id = section.id
%}

<style>
    .section-container--{{ id }}{
      margin-top: {{ section.settings.margin_top | append:'px' }};
      margin-bottom: {{ section.settings.margin_bottom | append:'px' }};
      padding-top: {{ section.settings.padding_top | append:'px' }};
      padding-bottom: {{ section.settings.padding_bottom | append:'px' }};
      background-color: {{ section.settings.bg-color }};
      overflow: hidden;
      .main {
          max-width: 856px;
          margin: auto;
      }      
    }
    @media screen and (max-width: 768px){
      .section-container--{{ id }}{
        margin-top: {{ section.settings.margin_top_mobile | append:'px' }};
        margin-bottom: {{ section.settings.margin_bottom_mobile | append:'px'  }};
        padding-top: {{ section.settings.padding_top_mobile | append:'px' }};
        padding-bottom: {{ section.settings.padding_bottom_mobile | append:'px' }};
      }
    }
    .accordion-wrapper--custom {
      {% comment %} column-count: 2;
      @media(max-width: 1200px) {
        column-count: 1;
      } {% endcomment %}
    }
    .section-container--{{ id }}{
      .accordion--custom path{
        {% comment %} stroke: #AA7248; {% endcomment %}
      }
      .icons {
        position: relative;
        display: flex;
        align-items: center;
        height: 100%;
        width: 28px;
        height: 28px;
      grid-column: 1;
      grid-row: 1;
      }
      .icons>div {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          svg {
            width: 20px;
            height: 20px;
          }

      }
      .accordion--custom.active .plus  {
          visibility: hidden;
          opacity: 0;
          transition: all 0.15s;
      }
      .accordion--custom .plus {
          visibility: visible;
          opacity: 1;
          transition: all 0.15s;
      }
      .accordion--custom.active .minus  {
          visibility: visible;
          opacity: 1;
          transition: all 0.15s;
      }
      .accordion--custom .minus {
          visibility: hidden;
          opacity: 0;
          transition: all 0.15s;
      }
    }


    .section-container--{{ id }}{

    .--section-title{
   color: var(--Black, #222);
  font-family: Prata;
  font-size: 36px;
  font-style: normal;
  font-weight: 400;
  line-height: 129%; /* 46.44px */
  letter-spacing: -0.72px;
  em {
    display: block;
    font-style: normal;
    @media(max-width: 768px) {
      display: unset;
    }
  }
      @media(max-width: 768px){
        font-size: 30px;
       }
    }


    }
</style>
<section class="section-container--{{ id }} faq-list-v3__container">
  <div class="section-wrapper--{{ id }} {% unless section.settings.full_width %}page-width{% endunless %}">
    <div class="main">
      <div class="info">
        <h2 class="--section-title center">{{ section.settings.heading }}</h2>
      </div>
      <div class="accordion-wrapper">
        <div class="accordion-wrapper-first--abc accordion-wrapper--custom">
          {% for block in section.blocks %}
            {% if block.type == 'item' %}
              <div class="accordion--custom">
                <div class="acr-title">
                  <h4 class="faq-question">{{ block.settings.title }}</h4>
                  <div class="icons">
                    <div class="plus">{% render 'all-icons', name: 'plus' %}</div>
                    <div class="minus">{% render 'all-icons', name: 'minus' %}</div>
                  </div>
                </div>
                <div class="acr-content">
                  <div class="faq__content__wrap">
                    {% unless block.settings.text == blank %}
                      <div class="faq__content">
                        {{ block.settings.text }}
                      </div>
                    {% endunless %}
                    {% unless block.settings.btn_label == blank %}
                      <a class="button" href="{{ block.settings.btn_link }}">{{ block.settings.btn_label }}</a>
                    {% endunless %}
                    {% unless block.settings.text1 == blank %}
                      <div class="faq__content">
                        {{ block.settings.text1 }}
                      </div>
                    {% endunless %}
                    {% unless block.settings.btn_label1 == blank %}
                      <a class="button" href="{{ block.settings.btn_link1 }}">{{ block.settings.btn_label1 }}</a>
                    {% endunless %}
                    {% unless block.settings.text2 == blank %}
                      <div class="faq__content">
                        {{ block.settings.text2 }}
                      </div>
                    {% endunless %}
                    {% unless block.settings.btn_label2 == blank %}
                      <a class="button" href="{{ block.settings.btn_link2 }}">{{ block.settings.btn_label2 }}</a>
                    {% endunless %}
                  </div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Accordion Setup
  class Accordioncustom {
    constructor(accordion = '', newOptions) {
      let options = {
        initOpenIndex: 1,
        closeAll: true,
        duration: 400,
        activeClass: 'active',
        globalClose: true,
        isFirstAccordion: false,
      };
      this.options = { ...options, ...newOptions };
      this.accordions = document.querySelectorAll(accordion);

      this.accordions.forEach((accordion, index) => {
        this.initAccordion(accordion, index);
      });
    }

    initAccordion(accordion, accordionIndex) {
      const tabItemsArray = Array.from(accordion.children);

      if (this.options.initOpenIndex > tabItemsArray.length) {
        this.options.initOpenIndex = tabItemsArray.length;
      }

      tabItemsArray.forEach((tabElement, index) => {
        let item = this.getAccordionItems(tabElement);
        this.contentInitialHeight(item[1]);

        if (index === this.options.initOpenIndex - 1 && this.options.isFirstAccordion) {
          this.InitialOpen(item);
        } else {
          this.close(item);
        }

        item[0].addEventListener('click', () => {
          this.toggle(tabItemsArray, item);
        });
      });
    }

    getAccordionItems(accordion) {
      let title = accordion.children[0];
      let content = accordion.children[1];
      return [title, content];
    }

    contentInitialHeight(content) {
      content.style.height = '0px';
      content.style.overflow = 'hidden';
    }

    InitialOpen(item) {
      this.setActiveClass(item);
      this.open(item);
    }

    open(item) {
      let content = item[1];
      this.transition(content);
      content.style.height = `${content.scrollHeight}px`;
    }

    close(item) {
      let content = item[1];
      content.style.height = '0px';
    }

    toggle(tabItemsArray, item) {
      const isOpen = item[1].style.height !== '0px';

      if (this.options.globalClose) {
        document.querySelectorAll('.accordion--custom').forEach((tabItem) => {
          let itemToClose = this.getAccordionItems(tabItem);
          this.close(itemToClose);
          this.removeActiveClass(itemToClose);
        });
      } else {
        tabItemsArray.forEach((tabItem) => {
          let itemToClose = this.getAccordionItems(tabItem);
          this.close(itemToClose);
          this.removeActiveClass(itemToClose);
        });
      }

      if (!isOpen) {
        this.setActiveClass(item);
        this.open(item);
      }
    }

    transition(el) {
      el.style.transition = `all ${this.options.duration}ms ease`;
    }

    setActiveClass(item) {
      item[1].parentElement.classList.add(this.options.activeClass);
    }

    removeActiveClass(item) {
      item[1].parentElement.classList.remove(this.options.activeClass);
    }
  }

  // Initialize accordions
  new Accordioncustom('.accordion-wrapper-first--abc', {
    initOpenIndex: 1,
    duration: 700,
    activeClass: 'active',
    globalClose: true,
    isFirstAccordion: true,
  });
</script>

{% schema %}
{
  "name": "FAQ List",
  "settings": [
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "FAQ"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": true
    },
    {
      "type": "color",
      "id": "bg-color",
      "label": "Background Color"
    },
    {
      "type": "header",
      "content": "Desktop Spacing"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Padding Top",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 50
    },
    {
      "type": "header",
      "content": "Mobile Spacing"
    },
    {
      "type": "range",
      "id": "margin_top_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Margin Top (Mobile)",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Margin Bottom (Mobile)",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Padding Top  (Mobile)",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "label": "Padding Bottom  (Mobile)",
      "default": 20
    }
  ],
  "blocks": [
    {
      "name": "Item",
      "type": "item",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "header",
          "content": "Post 1",
          "info": "Job Post 1"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "text",
          "id": "btn_label",
          "label": "Button Label"
        },
        {
          "type": "url",
          "id": "btn_link",
          "label": "Button Link"
        },
        {
          "type": "header",
          "content": "Post 2",
          "info": "Job Post 2"
        },
        {
          "type": "richtext",
          "id": "text1",
          "label": "Text"
        },
        {
          "type": "text",
          "id": "btn_label1",
          "label": "Button Label"
        },
        {
          "type": "url",
          "id": "btn_link1",
          "label": "Button Link"
        },
        {
          "type": "header",
          "content": "Post 3",
          "info": "Job Post 3"
        },
        {
          "type": "richtext",
          "id": "text2",
          "label": "Text"
        },
        {
          "type": "text",
          "id": "btn_label2",
          "label": "Button Label"
        },
        {
          "type": "url",
          "id": "btn_link2",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ List"
    }
  ]
}
{% endschema %}
